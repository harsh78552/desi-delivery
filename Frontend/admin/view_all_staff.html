<!DOCTYPE html>
<html>
<head>
    <title>Staff List</title>
    <link rel="icon" type="image/png/jpg" href="../image/myImage.jpg">
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f3f3f3;
            padding: 20px;
        }

        h2 { text-align: center; }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            margin-top: 20px;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
            text-align: left;
        }

        th {
            background: #007bff;
            color: white;
        }

        tr:hover { background: #f1f1f1; }

        .loading {
            text-align: center;
            font-size: 18px;
            margin-top: 20px;
        }

        #pagination {
            text-align: center;
            margin-top: 20px;
            color:pink;
        }

        .page-btn {
            padding: 8px 12px;
            margin: 4px;
            border: none;
            background: #ddd;
            cursor: pointer;
            border-radius: 4px;
        }

        .active {
            background: #007bff;
            color: white;
        }
    </style>
</head>

<body>

<h2>Staff List</h2>
<div class="loading" id="loading">Loading data...</div>

<table id="userTable" style="display:none;">
    <thead>
    <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Contact</th>
        <th>Role</th>
        <th>State</th>
    </tr>
    </thead>
    <tbody></tbody>
</table>

<div id="pagination"></div>

<script>
    const token = localStorage.getItem("VyanjanamAdminToken");
    const API_URL = "https://restaurantfoodorderingsystem-6.onrender.com/get-staff";

    const table = document.getElementById("userTable");
    const tableBody = document.querySelector("#userTable tbody");
    const loading = document.getElementById("loading");
    const paginationDiv = document.getElementById("pagination");

    async function loadStaff(page = 1) {
        tableBody.innerHTML = "";
        loading.style.display = "block";

        try {
            const response = await fetch(`${API_URL}?page=${page}&limit=10`, {
                method: "GET",
                headers: {
                    Authorization: "Bearer " + token,
                    "Content-Type": "application/json"
                }
            });

            const result = await response.json();

            const staffData = result.data;
            const totalPages = result.total_pages;

            loading.style.display = "none";
            table.style.display = "table";

            staffData.forEach(u => {
                const row = `
                    <tr>
                        <td>${u.name}</td>
                        <td>${u.email}</td>
                        <td>${u.contact_no}</td>
                        <td>${u.role}</td>
                        <td>${u.state}</td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });

            loadPagination(totalPages, page);

        } catch (err) {
            loading.innerHTML = "Failed to load data!";
            console.error("Error:", err);
        }
    }

    function loadPagination(totalPages, currentPage) {
        paginationDiv.innerHTML = "";

        for (let i = 1; i <= totalPages; i++) {
            let btn = document.createElement("button");
            btn.innerText = i;
            btn.classList.add("page-btn");

            if (i === currentPage) {
                btn.classList.add("active");
            }

            btn.onclick = () => loadStaff(i);
            paginationDiv.appendChild(btn);
        }
    }
   loadStaff();
</script>

</body>
</html>
